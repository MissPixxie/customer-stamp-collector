generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DEV_DATABASE_URL")
}

model User {
  id             String   @id @default(cuid())
  username       String   @unique
  hashedPassword String
  role           Role     @default(USER)
  createdAt      DateTime @default(now())
}

model Member {
  id         Int         @id @default(autoincrement())
  membersNr  Int         @unique
  name       String?
  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt
  stampCards StampCard[]
}

model StampCard {
  id        Int           @id @default(autoincrement())
  membersNr Int
  type      StampCardType
  createdAt DateTime      @default(now())
  updatedAt DateTime      @updatedAt
  stamps    Stamp[]
  member    Member        @relation(fields: [membersNr], references: [id], onDelete: Cascade)
  pawStamps PawStamp[]

  @@index([membersNr], map: "StampCard_membersNr_fkey")
}

model Stamp {
  id          Int       @id @default(autoincrement())
  brand       String
  size        String?
  price       String
  stampCardid Int
  createdAt   DateTime  @default(now())
  stampCard   StampCard @relation(fields: [stampCardid], references: [id], onDelete: Cascade)

  @@index([stampCardid], map: "Stamp_stampCardid_fkey")
}

model PawStamp {
  id          Int       @id @default(autoincrement())
  stampCardid Int
  createdAt   DateTime  @default(now())
  stampCard   StampCard @relation(fields: [stampCardid], references: [id], onDelete: Cascade)

  @@index([stampCardid], map: "PawStamp_stampCardid_fkey")
}

enum StampCardType {
  Cat
  Dog
  Paw
}

enum Role {
  USER
  ADMIN
  MODERATOR
}
